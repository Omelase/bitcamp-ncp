<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>ex07</title>
  </head>
  <body>
    <h1>XMLHttpRequest 사용하기</h1>
    <table border="1">
      <thead>
        <tr>
          <th>번호</th>
          <th>제목</th>
          <th>작성자</th>
          <th>조회수</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <script>
      'use strict';

      var tbody = document.querySelector('tbody');

      let promise = fetch('http://localhost:3000/boards'); // ajax + promise
      let promise2 = promise.then((response) => {
        return response.json(); // 응답에서 text를 추출하여 객체로 deserialization을 수행하는 promise객체
      });
      promise2.then((arr) => {
        // console.log(arr);

        for (var b of arr) {
          var tr = document.createElement('tr');

          tr.innerHTML =
            '<td>' +
            b.no +
            '</td>' +
            '<td>' +
            b.title +
            '</td>' +
            '<td>' +
            b.writer +
            '</td>' +
            '<td>' +
            b.viewCnt +
            '</td>';

          tbody.appendChild(tr);
        }
      });

      // var xhr = new XMLHttpRequest();
      // xhr.onreadystatechange = () => {
      //   if (xhr.readyState == 4 && xhr.status == 200) {
      //   }
      // };
      // xhr.open('GET', 'http://localhost:3000/boards', true);
      // xhr.send();
    </script>
  </body>
</html>
